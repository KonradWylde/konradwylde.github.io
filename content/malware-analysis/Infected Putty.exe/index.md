---
title: Backdoor.ReverseShell.Putty.exe
description: Analyzing an infected putty executable
authors: konradwylde
tags:
  - malware
  - reversing
  - analysis
date: '2022-12-17'
draft: false
---


## Executive Summary
`Placeholder`


## Malware Composition

|  File Name     |  SHA256 Hash  |
|----------------|---------------|
|  putty.exe  |  0c82e654c09c8fd9fdf4899718efa37670974c9eec5a8fc18a167f93cea6ee83  |


## VT Analysis
[VT Link](https://www.virustotal.com/gui/file/0c82e654c09c8fd9fdf4899718efa37670974c9eec5a8fc18a167f93cea6ee83/relations) (Detection score 59/72)  
  
No other significative results to be reported.


## Basic Static Analysis
### FLOSS interesting findings
![floss-ouput](images/floss.png)

### PEStudio findings
* found a suspicious section: `.00cfg`
* found a suspicious entry-point `.text:0x00122000`

### IAT interesting findings
* `ShellExecuteA` and some Windows Registry related imports (may be Putty normal functionality related)


## Basic Dynamic Analysis
### Initial detonation
* upon detonation a blue Powershell window appears for a few seconds before the standard Putty window.

### Host-based indicators 
* a `Process Create` operation is executed after detonation, which confirms the Powershell command execution we found during the strings analysis.
![procmon1](images/procmon-1.png)

* the `process tree` can also confirm that putty.exe executed Powershell
![procmon2](images/procmon-2.png)
  
* by analysing any TCP operations we can notice that the Powershell command seems to be trying to establish a TCP connection to port `8443`
![procmon3](images/procmon-3.png)

### Network signatures
* found DNS queries to `bonus2.corporatebonusapplication[.]local`
![dns-queries](images/wireshark-dns.png)

* by setting up a listener on port `8443` and re-detonating the sample we can get a TCP connection (Wireshark reports a TLS `Client Hello`)
![netcat](images/netcat-1.png)
![tcp-connect](images/wireshark-tcp.png)


## Advanced Static Analysis
* TO DO: base64 decode and gzip decompressing the payload


## Advanced Dynamic Analysis
Not needed.


## Any.run Analysis
* by searching the SHA256SUM on App.any.run we can find some tasks [(Link here)](https://app.any.run/tasks/0ee9dac1-f2e8-406d-a141-3f8e0be6a5af/) that can confirm the Powershell payload and the DNS query. No other findinds are reported. 
![anyrun1](images/anyrun-1.png)


## Indicators of Compromise (IOCs)
### Network Indicators
`Placeholder`

### Network Indicators
`Placeholder`


## Rules & Signatures
`Placeholder`