---
title: RAT.ReverseShell.Putty.exe
description: Analyzing an infected putty executable
authors: konradwylde
tags:
  - malware
  - reversing
  - analysis
date: '2022-12-17'
draft: false
---


## Executive Summary
`Placeholder`


## Malware Composition

|  File Name     |  SHA256 Hash  |
|----------------|---------------|
|  putty.exe  |  0c82e654c09c8fd9fdf4899718efa37670974c9eec5a8fc18a167f93cea6ee83  |


## VT Analysis
[VT Link](https://www.virustotal.com/gui/file/0c82e654c09c8fd9fdf4899718efa37670974c9eec5a8fc18a167f93cea6ee83/relations) (Detection score 59/72)  
  
No other significative results to be reported.


## Basic Static Analysis
### FLOSS interesting findings
![floss-ouput](images/floss.png)

### PEStudio findings
* suspicious section: `.00cfg`
* suspicious entry-point `.text:0x00122000`

### IAT interesting findings
* `ShellExecuteA` and some Windows Registry related imports (may be Putty normal functionality related)


## Basic Dynamic Analysis
### Initial detonation
* upon detonation a blue Powershell window appears for a few seconds.

### Host-based indicators 
* After detonation a `Process Create` operation is executed, which confirms the Powershell command execution.
![procmon1](images/procmon-1.png)

* Process tree also confirms the Powershell execution
![procmon2](images/procmon-2.png)
  
* The Powershell command seems to be trying to establish a TCP connections to port `8443`
![procmon3](images/procmon-3.png)

### Network signatures
* DNS queries to `bonus2.corporatebonusapplication[.]local`
![dns-queries](images/wireshark-dns.png)

* By setting up a listener on port `8443` with Netcat and re-detonating the sample we get a TCP connection (Wireshark reports a TLS `Client Hello`)
![netcat](images/netcat-1.png)
![tcp-connect](images/wireshark-tcp.png)


## Advanced Static Analysis
* TO DO: base64 decode and gzip decompressing the payload


## Advanced Dynamic Analysis
`Placeholder`


## Any.run Analysis
`Placeholder`


## Indicators of Compromise (IOCs)
### Network Indicators
`Placeholder`

### Network Indicators
`Placeholder`


## Rules & Signatures
`Placeholder`